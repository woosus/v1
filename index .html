<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>홈 · GG ACADEMY</title>
<link rel="icon" href="LOGO.png">
<script src="https://cdn.tailwindcss.com"></script>
<style>
:root{
  --side: 25px;
  --wrapW: min(1920px, calc(100vw - 50px));
  --aside-w: 340px;
  --hero-h: 270px;
  --ease: cubic-bezier(.2,.8,.2,1);
}
*{box-sizing:border-box}
html,body{height:100%}
body{ background:#0a0b0e; color:#eaf2ff; font-family: ui-sans-serif,-apple-system,'Noto Sans KR',Segoe UI,Roboto,Helvetica,Arial;}
.topbar{ position:sticky; top:0; z-index:50; background:#07090c; border-bottom:1px solid rgba(255,255,255,.08); }
.topbar .wrap{ width:var(--wrapW); margin:0 auto; padding:10px 16px; display:flex; align-items:center; gap:16px; }
.topbar a{ color:#dbeafe; text-decoration:none; opacity:.95; padding:6px 10px; border-radius:10px; }
.topbar a:hover{ background:rgba(255,255,255,.08); opacity:1; }
.topbar .brand img{ height:48px; }
.topbar .spacer{ flex:1; }
.container{ width:var(--wrapW); margin:0 auto; padding:18px 16px; }
.grid-hero{ display:grid; grid-template-columns: 3fr 2fr; gap:16px; margin-bottom:18px; }
.hero{ background:linear-gradient(180deg,#0a0b0e,#0d1117); border:1px dashed rgba(255,255,255,.15); border-radius:14px; height:var(--hero-h); }
.card{ background:#0e1116; border:1px solid #1f2937; border-radius:14px; }
.section-title{ font-weight:800; font-size:18px; margin-bottom:8px; }
.cat-card{ width:var(--aside-w); }
.cat-bar{ display:flex; gap:8px; padding:8px 10px; border-bottom:1px solid #1f2937; background:#0e1116; }
.cat-btn{ padding:6px 10px; border:1px solid #1f2937; border-radius:10px; background:transparent; font-weight:700; color:#cbd5e1; cursor:pointer; }
.cat-btn:hover{ background:rgba(255,255,255,.04); }
.cat-btn.active{ border-color:#3b82f6; color:#60a5fa; background:rgba(37,99,235,.12); }
.subcat-wrap{ overflow:hidden; transition:height 800ms var(--ease); height:0px; }
.menu-list{ padding:10px; }
.subpill{ width:100%; height:40px; display:flex; align-items:center; justify-content:flex-start;
  padding:0 14px; margin:8px 0; border-radius:12px; border:1px solid #334155;
  background:linear-gradient(90deg,#0b1220 0%,#0f1d37 60%,#0b1324 100%); color:#e5f0ff;
  font-weight:800; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  opacity:0; transform:translateY(-6px); transition:opacity .45s, transform .45s; }
.subpill.show{ opacity:1; transform:translateY(0); }
.subpill.active{ border-color:#22d3ee; color:#f8fafc; box-shadow: 0 0 8px rgba(34,211,238,.7), 0 0 16px rgba(34,211,238,.45); }
@keyframes neonBlink3{ 0%,100%{ box-shadow: 0 0 8px rgba(34,211,238,.7), 0 0 16px rgba(34,211,238,.45); opacity:1; }
  50%{ box-shadow: 0 0 2px rgba(34,211,238,.2), 0 0 6px rgba(34,211,238,.15); opacity:.85; } }
.subpill.blink{ animation: neonBlink3 3s ease-in-out 1; }
@media (max-width: 960px){ .grid-hero{ grid-template-columns: 1fr; } }
</style>
</head>
<body>
<header class="topbar">
  <div class="wrap">
    <a href="index_v0_5.html" class="brand" aria-label="홈"><img src="LOGO.png" alt="GG ACADEMY 로고"></a>
    <nav class="flex flex-wrap gap-1">
      <a href="academy.html">아카데미 소개</a>
      <a href="#compare">비교검색</a>
      <a href="promo.html" target="_blank" rel="noopener">누구나무료홍보</a>
      <a href="insurance.html" target="_blank" rel="noopener">비교보험</a>
      <a href="ggin.html" target="_blank" rel="noopener">GGin 후기</a>
      <a href="tiers.html">등급 체계</a>
      <a href="contact.html">문의</a>
    </nav>
    <div class="spacer"></div>
    <a href="signup_v0_5.html">가입</a>
    <a href="login.html">로그인</a>
  </div>
</header>

<main class="container">
  <section class="grid-hero">
    <div class="hero" id="heroTop1" aria-label="검색 1위 전용 슬롯"></div>
    <div class="card p-4" id="pollCard">
      <div class="section-title"><span id="pollTopic">누구나 참여 설문조사</span></div>
      <div class="text-slate-300 text-sm mb-2">참여 인원: <b><span id="pollTotal">0</span></b> / 100</div>
      <div class="flex gap-2 flex-wrap mb-2" id="pollOptions"></div>
      <div class="w-full h-4 bg-slate-800 rounded-full overflow-hidden mb-2">
        <div id="pollBar" class="h-4" style="width:0%"></div>
      </div>
      <div id="pollDots" class="grid grid-cols-10 gap-1 mb-3"></div>
      <div id="pollResult" class="hidden mt-2 p-3 rounded-md border border-sky-700 text-slate-100" style="background:rgba(3,105,161,.3)"></div>
      <p class="text-slate-400 text-xs">* 2/3/4지선다 — 주소에 <code>?poll=3</code>, <code>?poll=4</code>, <code>?topic=주제</code></p>
    </div>
  </section>

  <div id="compare" class="grid" style="grid-template-columns: 1fr var(--aside-w); gap:16px; align-items:start;">
    <div class="card p-4">
      <div class="section-title">안내</div>
      <p class="text-slate-300">우측 상단의 <b>스포츠 · 카지노 · 슬롯</b>을 <u>여러 개 동시에</u> 선택할 수 있습니다. 모두 해제하면 <b>중분류가 자동으로 접혀</b> 프로필이 위로 올라옵니다.</p>
      <div id="selSummary" class="mt-3 text-sky-300 text-sm hidden"></div>
    </div>
    <aside class="flex flex-col gap-4 items-end">
      <div class="card cat-card" id="catCard">
        <div class="cat-bar">
          <button class="cat-btn" data-cat="스포츠" aria-pressed="false">스포츠</button>
          <button class="cat-btn" data-cat="카지노" aria-pressed="false">카지노</button>
          <button class="cat-btn" data-cat="슬롯" aria-pressed="false">슬롯</button>
        </div>
        <div id="subWrap" class="subcat-wrap">
          <div id="subList" class="menu-list"></div>
        </div>
      </div>
      <div class="card" style="width:var(--aside-w);">
        <div class="p-4">
          <div class="text-xl font-extrabold">프로필</div>
          <p class="text-slate-300 mt-2 text-sm">현재 선택된 카테고리는 요약에서 확인하세요.</p>
          <p class="text-slate-300 mt-2 text-sm">이벤트 참여: <b><span id="profileCount">0</span></b>회</p>
        </div>
      </div>
    </aside>
  </div>
</main>

<script>
(function(){
  (function(){
    const TARGET = 100;
    const qs = new URLSearchParams(location.search);
    const MODE = parseInt(qs.get('poll') || localStorage.getItem('pollMode') || '2');
    const CHOICES = (MODE===4) ? ['A안','B안','C안','D안'] : (MODE===3 ? ['A안','B안','C안'] : ['A안','B안']);
    const topic = qs.get('topic') || localStorage.getItem('pollTopic') || '누구나 참여 설문조사';
    localStorage.setItem('pollMode', String(MODE));
    localStorage.setItem('pollTopic', topic);

    const totalEl = document.getElementById('pollTotal');
    const bar = document.getElementById('pollBar');
    const dotsWrap = document.getElementById('pollDots');
    const optsWrap = document.getElementById('pollOptions');
    const resultBox = document.getElementById('pollResult');
    const topicEl = document.getElementById('pollTopic');
    if (topicEl) topicEl.textContent = topic;

    if (dotsWrap){
      dotsWrap.innerHTML='';
      for(let i=0;i<TARGET;i++){
        const d=document.createElement('div');
        d.style.cssText='height:10px;border-radius:3px;background:#1f2937';
        dotsWrap.appendChild(d);
      }
    }
    const dots = dotsWrap ? Array.from(dotsWrap.children) : [];

    function renderOptions(disabled){
      if(!optsWrap) return;
      optsWrap.innerHTML = CHOICES.map((label,idx)=>
        '<button class="px-3 py-2 rounded-md border border-sky-400 hover:bg-sky-900/30 text-slate-100" data-idx="'+idx+'" '+(disabled?'disabled':'')+'>'+label+'</button>'
      ).join('');
    }

    function loadState(){
      try{
        const raw = localStorage.getItem('pollState');
        if(!raw) return {mode:MODE, counts:new Array(CHOICES.length).fill(0), total:0, closed:false};
        const s = JSON.parse(raw);
        if (s.mode!==MODE || !Array.isArray(s.counts) || s.counts.length!==CHOICES.length)
          return {mode:MODE, counts:new Array(CHOICES.length).fill(0), total:0, closed:false};
        return s;
      }catch(e){
        return {mode:MODE, counts:new Array(CHOICES.length).fill(0), total:0, closed:false};
      }
    }
    function saveState(s){ localStorage.setItem('pollState', JSON.stringify(s)); }

    function refreshUI(s){
      if(totalEl) totalEl.textContent = s.total;
      if(bar){ const pct=Math.min(100, Math.round((s.total/TARGET)*100)); bar.style.width=pct+'%'; }
      if(dots.length){ dots.forEach((d,i)=> d.style.background = (i<s.total)? '#38bdf8' : '#1f2937'); }

      const disabled = s.closed || s.total>=TARGET || !!localStorage.getItem('votedOnce');
      renderOptions(disabled);

      if(optsWrap){
        Array.from(optsWrap.querySelectorAll('button')).forEach(btn=>{
          btn.addEventListener('click', ()=>{
            if(localStorage.getItem('votedOnce')) return;
            let ns = loadState();
            if(ns.total>=TARGET) return;
            ns.counts[parseInt(btn.dataset.idx)] += 1;
            ns.total += 1;
            if(ns.total>=TARGET) ns.closed=true;
            saveState(ns);
            try{ let p=parseInt(localStorage.getItem('participationCount')||'0'); localStorage.setItem('participationCount', String(p+1)); }catch(e){}
            localStorage.setItem('votedOnce','1');
            refreshUI(ns);
          });
        });
      }

      if(s.total>=TARGET || s.closed){
        const ratio = s.counts.join(' : ');
        const per = s.counts.map(c => (s.total? Math.round(c/s.total*100):0)+'%').join(' / ');
        if(resultBox){ resultBox.classList.remove('hidden'); resultBox.innerHTML='<b>최종 결과</b> · '+ratio+' <span class="text-slate-300">( '+per+' )</span>'; }
      } else { if(resultBox){ resultBox.classList.add('hidden'); resultBox.textContent=''; } }
    }

    refreshUI(loadState());
  })();

  const SUB = ['첫입금 보너스 높은순','첫충전 보너스 높은순','재충전 보너스 높은순','올인 보너스 높은순','당일페이백 높은순','주간페이백 높은순'];
  const btns = Array.from(document.querySelectorAll('.cat-btn'));
  const subWrap = document.getElementById('subWrap');
  const subList = document.getElementById('subList');
  const summary = document.getElementById('selSummary');
  const profileCount = document.getElementById('profileCount');

  function renderSub(){
    subList.innerHTML = SUB.map(t => '<button class="subpill" type="button" data-key="'+t+'"><span>'+t+'</span></button>').join('');
    const subs = Array.from(subList.querySelectorAll('.subpill'));
    subs.forEach((el,i)=> setTimeout(()=> el.classList.add('show'), i*80));
    subs.forEach(el => el.addEventListener('click', ()=>{
      subs.forEach(x=> x.classList.remove('active'));
      el.classList.add('active','blink');
      setTimeout(()=> el.classList.remove('blink'), 3000);
      updateSummary(el.dataset.key);
    }));
  }

  function selectedCats(){ return btns.filter(b => b.classList.contains('active')).map(b => b.dataset.cat); }

  function animateTo(h){
    if(!subWrap) return;
    subWrap.style.height = subWrap.clientHeight + 'px';
    requestAnimationFrame(()=>{ subWrap.style.height = h + 'px'; });
  }

  function openPanel(){ renderSub(); requestAnimationFrame(()=> animateTo(subList.scrollHeight)); }
  function closePanel(){ animateTo(0); }

  function updateSummary(sortKey){
    const cats = selectedCats();
    const catText = cats.length ? cats.join(', ') : '없음';
    const sortText = sortKey || (document.querySelector('.subpill.active')?.dataset.key || '미선택');
    summary.innerHTML = '<b>선택된 카테고리</b>: '+catText+' / <b>정렬</b>: '+sortText;
    summary.classList.toggle('hidden', cats.length===0 && !sortKey);
  }

  function toggleCat(btn){
    const active = btn.classList.contains('active');
    btn.classList.toggle('active', !active);
    btn.setAttribute('aria-pressed', String(!active));
    const any = selectedCats().length > 0;
    if(any){ openPanel(); } else { closePanel(); }
    updateSummary();
  }

  btns.forEach(b => b.addEventListener('click', ()=> toggleCat(b)));

  try{ profileCount.textContent = parseInt(localStorage.getItem('participationCount')||'0'); }catch(e){}

  btns[0].classList.add('active'); btns[0].setAttribute('aria-pressed','true'); openPanel(); updateSummary();
})();
</script>
</body>
</html>
